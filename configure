#!/usr/local/bin/bash

# ---------------------------------------- #
# Programer: PEDRO RIVERO
# Date: Nov 4 2019
# ---------------------------------------- #

BIN_NAME='prr-backup'
LIB_NAME='src'
INSTALLATION_LOCATION='/usr/local/bin'

BIN_PATH="${INSTALLATION_LOCATION}/${BIN_NAME}"
LIB_PATH="${INSTALLATION_LOCATION}/${BIN_NAME}-${LIB_NAME}"


## ---- INSTALLATION ---- ##

if [ ! -e "${BIN_NAME}.sh" ]; then
  echo "ERROR: Missing '${BIN_NAME}.sh'."
  echo "Please run this configuration from within its parent directory: './configure'."

elif [ ! -e "${LIB_NAME}/filesystem.sh" ]; then
  echo "ERROR: Missing '${LIB_NAME}/filesystem.sh'."
  echo "Please run this configuration from within its parent directory: './configure'."

elif [ ! -e "${LIB_NAME}/functionality.sh" ]; then
  echo "ERROR: Missing '${LIB_NAME}/functionality.sh'."
  echo "Please run this configuration from within its parent directory: './configure'."

elif [ ! -e "${LIB_NAME}/logs.sh" ]; then
  echo "ERROR: Missing '${LIB_NAME}/logs.sh'."
  echo "Please run this configuration from within its parent directory: './configure'."

elif [ ! -e "${LIB_NAME}/parsing.sh" ]; then
  echo "ERROR: Missing '${LIB_NAME}/parsing.sh'."
  echo "Please run this configuration from within its parent directory: './configure'."

else

  chmod 766 prr-backup.sh

  rm -rf ${LIB_PATH} 2>/dev/null
  ln -s "${PWD}/${LIB_NAME}" ${LIB_PATH}

  rm -rf ${BIN_PATH} 2>/dev/null
  ln -s "${PWD}/${BIN_NAME}.sh" ${BIN_PATH}

  echo "Succesful configuration of ${BIN_NAME}!"

fi
